---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout title="Search" description="Search posts and pages">
  <div class="container">
    <div class="mb-8">
      <h1 class="text-3xl font-bold mb-3">Search</h1>
      <p class="text-zinc-700 dark:text-zinc-300 text-base">Find content across posts and pages.</p>
    </div>

    <div id="pagefind-search" class="border border-zinc-200 dark:border-zinc-700 rounded-2xl p-4 shadow-sm bg-white dark:bg-zinc-900/60"></div>
  </div>

  <link rel="stylesheet" href="/pagefind/pagefind-ui.css">
  <script src="/pagefind/pagefind-ui.js" is:inline></script>
  <script>
    // PagefindUI is provided by the loaded script; declare for type safety.
    // eslint-disable-next-line @typescript-eslint/no-explicit-any
    const PagefindUI: any = (globalThis as any).PagefindUI;
    window.addEventListener('DOMContentLoaded', () => {
      // Initialize Pagefind UI with minimal config; searches use the generated index in /pagefind
      new PagefindUI({
        element: '#pagefind-search',
        showSubResults: true,
      });
    });
  </script>

  <style>
    /* Improve Pagefind contrast in dark mode */
    :global(.dark #pagefind-search) {
      color: #e4e4e7;
    }
    :global(.dark #pagefind-search a),
    :global(.dark #pagefind-search .pagefind-ui__result-link),
    :global(.dark #pagefind-search .pagefind-ui__result-title) {
      color: #e4e4e7;
    }
    :global(.dark #pagefind-search .pagefind-ui__result-excerpt),
    :global(.dark #pagefind-search .pagefind-ui__message),
    :global(.dark #pagefind-search .pagefind-ui__result-url) {
      color: #cbd5e1;
    }
    :global(.dark #pagefind-search .pagefind-ui__button),
    :global(.dark #pagefind-search .pagefind-ui__search-input),
    :global(.dark #pagefind-search .pagefind-ui__search-input::placeholder) {
      color: #e4e4e7;
    }
    :global(.dark #pagefind-search .pagefind-ui__result) {
      background: rgba(24,24,27,0.65);
      border-color: rgba(113,113,122,0.6);
    }
    :global(.dark #pagefind-search .pagefind-ui__form),
    :global(.dark #pagefind-search .pagefind-ui__search-input) {
      background: rgba(39,39,42,0.6);
      border-color: rgba(113,113,122,0.6);
    }
    :global(.dark #pagefind-search .pagefind-ui__result-thumb) {
      background: rgba(63,63,70,0.6);
      border-color: rgba(113,113,122,0.45);
    }
    :global(.dark #pagefind-search .pagefind-ui__button) {
      background: rgba(82,82,91,0.7);
      border-color: rgba(113,113,122,0.8);
    }
    :global(.dark #pagefind-search .pagefind-ui__button:hover) {
      background: rgba(113,113,122,0.85);
      border-color: rgba(161,161,170,0.9);
    }
    :global(#pagefind-search .pagefind-ui__search-clear) {
      background: #f8fafc;
      color: #0f172a;
      border: 1px solid rgba(15, 23, 42, 0.12);
      border-radius: 999px;
      padding: 0.3rem 0.9rem;
      font-weight: 600;
      transition: background-color 180ms ease, color 180ms ease, border-color 180ms ease, box-shadow 180ms ease;
      box-shadow: 0 6px 14px rgba(15, 23, 42, 0.08);
    }
    :global(#pagefind-search .pagefind-ui__search-clear:hover) {
      background: #e2e8f0;
      border-color: rgba(15, 23, 42, 0.24);
      box-shadow: 0 8px 18px rgba(15, 23, 42, 0.12);
    }
    :global(.dark #pagefind-search .pagefind-ui__search-clear) {
      background: #0b0b0f;
      color: #f8fafc;
      border: 1px solid rgba(248, 250, 252, 0.35);
      border-radius: 999px;
      padding: 0.3rem 0.9rem;
      font-weight: 600;
      box-shadow: 0 6px 14px rgba(0, 0, 0, 0.4);
    }
    :global(.dark #pagefind-search .pagefind-ui__search-clear:hover) {
      background: #11111a;
      border-color: rgba(248, 250, 252, 0.55);
      box-shadow: 0 10px 22px rgba(0, 0, 0, 0.5);
    }
    :global(.dark #pagefind-search .pagefind-ui__result-highlight) {
      background: rgba(250,204,21,0.18);
      color: #fef08a;
    }
  </style>
</BaseLayout>
