---
import { Image } from 'astro:assets';
import type { Publications } from '../pages/publications/publications';
import CiteButton from './CiteButton.astro';
import { HOVER_ABSTRACT_ENABLED } from '@src/consts';

interface Props {
  publication: Publications;
}

const { publication } = Astro.props;
---

<div class="group relative flex flex-col md:flex-row overflow-hidden h-40 rounded-xl glass-panel hover:scale-[1.015] transition-all duration-300">
  <a href={publication.paperLink} target="_blank" rel={publication.paperLinkRel} class="hidden md:block md:w-1/5 w-full overflow-hidden bg-zinc-100 dark:bg-zinc-800 relative aspect-video md:aspect-auto">
    {publication.coverImage && (
      <Image
        src={publication.coverImage}
        alt={publication.name}
        class="h-full w-full object-cover object-center transition-transform duration-300 group-hover:scale-105"
        width={720}
        height={360}
      />
    )}
    {!publication.coverImage && (
      <div class="flex h-full items-center justify-center text-zinc-400 dark:text-zinc-600">
        <span class="text-sm">No Image</span>
      </div>
    )}
  </a>
  <div class="relative flex flex-1 flex-col p-5 w-full md:w-2/3">
    <div class="absolute top-2 right-3 text-2xl font-bold text-zinc-500/40 dark:text-zinc-400/40">
      {publication.year}
    </div>
    <div class="mb-2 text-sm text-zinc-500 dark:text-zinc-400">
      {publication.journal}
    </div>
    <h3 class="mb-2 text-base font-bold leading-tight text-zinc-900 dark:text-zinc-100 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors">
      <a href={publication.paperLink} target="_blank" rel={publication.paperLinkRel}>{publication.name}</a>
    </h3>
    <div class="text-sm text-zinc-600 dark:text-zinc-400">
        {publication.authors?.map((author, index) => (
            <a href={author.url} target="_blank" class="hover:underline">{author.name}</a>
        )).reduce((prev, curr) => <>{prev}, {curr}</>)}
    </div>
    <div class="flex justify-end gap-3 mt-auto self-end">
      {publication.bibtex && <CiteButton bibtex={publication.bibtex} />}
      {
          publication.pdf &&
          <a class="tag-pill" href={publication.pdf} target="_blank" rel={publication.paperLinkRel}>
              PDF
          </a>
      }
      {
          publication.paperLink &&
          <a class="tag-pill" href={publication.paperLink} target="_blank" rel={publication.paperLinkRel}>
              Paper
          </a>
      }
    </div>
  </div>
</div>
